/* ============================================================================
   APPLE HIG DESIGN SYSTEM
   Based on Apple Human Interface Guidelines
   Supports Light & Dark Mode with Blue Accent
   ============================================================================ */

/* ============================================================================
   LIGHT MODE (Default)
   ============================================================================ */
:root {
  /* === COLOR SCHEME === */
  color-scheme: light dark;
  
  /* === BACKGROUNDS === */
  --system-background: #ffffff;
  --system-background-secondary: #f2f2f7;
  --system-background-tertiary: #ffffff;
  --system-background-elevated: #ffffff;
  --system-grouped-background: #f2f2f7;
  --system-grouped-background-secondary: #ffffff;
  
  /* === FILLS (for UI elements) === */
  --fill-primary: rgba(120, 120, 128, 0.2);
  --fill-secondary: rgba(120, 120, 128, 0.16);
  --fill-tertiary: rgba(120, 120, 128, 0.12);
  --fill-quaternary: rgba(120, 120, 128, 0.08);
  
  /* === LABELS (text colors) === */
  --label-primary: #000000;
  --label-secondary: rgba(60, 60, 67, 0.6);
  --label-tertiary: rgba(60, 60, 67, 0.3);
  --label-quaternary: rgba(60, 60, 67, 0.18);
  
  /* === SEPARATORS === */
  --separator: rgba(60, 60, 67, 0.29);
  --separator-opaque: #c6c6c8;
  
  /* === SYSTEM COLORS (Light Mode) === */
  --system-red: #ff3b30;
  --system-orange: #ff9500;
  --system-yellow: #ffcc00;
  --system-green: #34c759;
  --system-mint: #00c7be;
  --system-teal: #30b0c7;
  --system-cyan: #32ade6;
  --system-blue: #007aff;
  --system-indigo: #5856d6;
  --system-purple: #af52de;
  --system-pink: #ff2d55;
  
  /* === TINT COLOR (Blue Accent) === */
  --tint-color: #007aff;
  --tint-color-secondary: #0051a8;
  --tint-color-light: rgba(0, 122, 255, 0.1);
  --tint-color-medium: rgba(0, 122, 255, 0.2);
  
  /* === POSITIVE/NEGATIVE INDICATORS === */
  --positive-color: #34c759;
  --negative-color: #ff3b30;
  
  /* === MATERIAL EFFECTS === */
  --material-thin: rgba(255, 255, 255, 0.5);
  --material-regular: rgba(255, 255, 255, 0.7);
  --material-thick: rgba(255, 255, 255, 0.9);
  --material-ultra-thin: rgba(255, 255, 255, 0.3);
  
  /* === SHADOWS === */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.12), 0 4px 12px rgba(0, 0, 0, 0.08);
  --shadow-xl: 0 24px 80px rgba(0, 0, 0, 0.16), 0 8px 24px rgba(0, 0, 0, 0.1);
  
  /* === GLOW EFFECTS === */
  --glow-tint: 0 0 20px rgba(0, 122, 255, 0.3);
  --glow-blue: 0 0 20px rgba(0, 122, 255, 0.3);
  --glow-positive: 0 0 20px rgba(52, 199, 89, 0.3);
  --glow-green: 0 0 20px rgba(52, 199, 89, 0.3);
  --glow-negative: 0 0 20px rgba(255, 59, 48, 0.3);
}

/* ============================================================================
   DARK MODE - Applied via data-theme attribute (set by JS)
   ============================================================================ */
:root[data-theme="dark"],
:root.dark {
  /* === BACKGROUNDS === */
  --system-background: #000000;
  --system-background-secondary: #1c1c1e;
  --system-background-tertiary: #2c2c2e;
  --system-background-elevated: #1c1c1e;
  --system-grouped-background: #000000;
  --system-grouped-background-secondary: #1c1c1e;
  
  /* === FILLS (for UI elements) === */
  --fill-primary: rgba(120, 120, 128, 0.36);
  --fill-secondary: rgba(120, 120, 128, 0.32);
  --fill-tertiary: rgba(120, 120, 128, 0.24);
  --fill-quaternary: rgba(120, 120, 128, 0.18);
  
  /* === LABELS (text colors) - Higher contrast for readability === */
  --label-primary: #ffffff;
  --label-secondary: #b0b0b8;
  --label-tertiary: #8e8e93;
  --label-quaternary: #6e6e73;
  
  /* === SEPARATORS === */
  --separator: rgba(84, 84, 88, 0.65);
  --separator-opaque: #48484a;
  
  /* === SYSTEM COLORS (Dark Mode - Adjusted) === */
  --system-red: #ff453a;
  --system-orange: #ff9f0a;
  --system-yellow: #ffd60a;
  --system-green: #30d158;
  --system-mint: #63e6e2;
  --system-teal: #40c8e0;
  --system-cyan: #64d2ff;
  --system-blue: #0a84ff;
  --system-indigo: #5e5ce6;
  --system-purple: #bf5af2;
  --system-pink: #ff375f;
  
  /* === TINT COLOR (Blue Accent - Dark) === */
  --tint-color: #0a84ff;
  --tint-color-secondary: #409cff;
  --tint-color-light: rgba(10, 132, 255, 0.2);
  --tint-color-medium: rgba(10, 132, 255, 0.3);
  
  /* === POSITIVE/NEGATIVE INDICATORS === */
  --positive-color: #30d158;
  --negative-color: #ff453a;
  
  /* === MATERIAL EFFECTS === */
  --material-thin: rgba(40, 40, 40, 0.6);
  --material-regular: rgba(40, 40, 40, 0.8);
  --material-thick: rgba(40, 40, 40, 0.95);
  --material-ultra-thin: rgba(40, 40, 40, 0.4);
  
  /* === SHADOWS (Darker for dark mode) === */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(0, 0, 0, 0.12);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.25), 0 2px 4px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 12px 40px rgba(0, 0, 0, 0.35), 0 4px 12px rgba(0, 0, 0, 0.2);
  --shadow-xl: 0 24px 80px rgba(0, 0, 0, 0.45), 0 8px 24px rgba(0, 0, 0, 0.25);
}

/* ============================================================================
   TYPOGRAPHY SYSTEM (SF Pro Style)
   ============================================================================ */
:root {
  /* === FONT FAMILY === */
  --font-system: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 
                 'Helvetica Neue', 'Segoe UI', Roboto, system-ui, sans-serif;
  --font-rounded: 'SF Pro Rounded', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'SF Mono', ui-monospace, 'Menlo', 'Monaco', 'Cascadia Code', monospace;
  
  /* === TYPE SCALE (iOS Large Title â†’ Caption 2) === */
  --text-large-title: 34px;
  --text-title-1: 28px;
  --text-title-2: 22px;
  --text-title-3: 20px;
  --text-headline: 17px;
  --text-body: 17px;
  --text-callout: 16px;
  --text-subheadline: 15px;
  --text-footnote: 13px;
  --text-caption-1: 12px;
  --text-caption-2: 11px;
  
  /* === FONT WEIGHTS === */
  --weight-regular: 400;
  --weight-medium: 500;
  --weight-semibold: 600;
  --weight-bold: 700;
  
  /* === LINE HEIGHTS === */
  --leading-tight: 1.15;
  --leading-snug: 1.25;
  --leading-normal: 1.4;
  --leading-relaxed: 1.6;
  
  /* === LETTER SPACING === */
  --tracking-tight: -0.02em;
  --tracking-normal: 0;
  --tracking-wide: 0.02em;
}

/* ============================================================================
   SPACING SYSTEM (8-Point Grid)
   ============================================================================ */
:root {
  --space-0: 0;
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-7: 28px;
  --space-8: 32px;
  --space-10: 40px;
  --space-12: 48px;
  --space-16: 64px;
  --space-20: 80px;
  --space-24: 96px;
  
  --margin-horizontal: 16px;
  --margin-horizontal-large: 20px;
  --touch-target-min: 44px;
}

/* ============================================================================
   BORDER RADIUS
   ============================================================================ */
:root {
  --radius-xs: 4px;
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
  --radius-2xl: 24px;
  --radius-3xl: 32px;
  --radius-full: 9999px;
}

/* ============================================================================
   ANIMATION & MOTION
   ============================================================================ */
:root {
  --duration-instant: 0.1s;
  --duration-fast: 0.2s;
  --duration-normal: 0.3s;
  --duration-slow: 0.4s;
  --duration-slower: 0.5s;
  
  --ease-default: cubic-bezier(0.25, 0.1, 0.25, 1);
  --ease-in: cubic-bezier(0.42, 0, 1, 1);
  --ease-out: cubic-bezier(0, 0, 0.58, 1);
  --ease-in-out: cubic-bezier(0.42, 0, 0.58, 1);
  --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

/* ============================================================================
   BASE RESET & DEFAULTS
   ============================================================================ */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

body {
  font-family: var(--font-system);
  font-size: var(--text-body);
  line-height: var(--leading-normal);
  color: var(--label-primary);
  background-color: var(--system-background);
  transition: background-color var(--duration-normal), color var(--duration-normal);
}

/* ============================================================================
   HIG COMPONENT CLASSES
   ============================================================================ */

/* === BUTTONS === */
.hig-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  min-height: var(--touch-target-min);
  padding: var(--space-3) var(--space-5);
  font-family: var(--font-system);
  font-size: var(--text-body);
  font-weight: var(--weight-semibold);
  line-height: 1;
  text-decoration: none;
  border-radius: var(--radius-md);
  border: none;
  cursor: pointer;
  transition: all var(--duration-fast) var(--ease-default);
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}

.hig-button:focus-visible {
  outline: 2px solid var(--tint-color);
  outline-offset: 2px;
}

.hig-button:active {
  transform: scale(0.97);
}

.hig-button-primary {
  background: var(--tint-color);
  color: #ffffff;
}

.hig-button-primary:hover {
  filter: brightness(1.1);
}

.hig-button-secondary {
  background: var(--fill-primary);
  color: var(--label-primary);
}

.hig-button-secondary:hover {
  background: var(--fill-secondary);
}

.hig-button-tertiary {
  background: transparent;
  color: var(--tint-color);
}

.hig-button-tertiary:hover {
  background: var(--fill-quaternary);
}

.hig-button-destructive {
  background: var(--system-red);
  color: #ffffff;
}

/* === CARDS === */
.hig-card {
  background: var(--system-background-secondary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  transition: transform var(--duration-fast) var(--ease-default),
              box-shadow var(--duration-fast) var(--ease-default);
}

.hig-card-elevated {
  background: var(--system-background-elevated);
  box-shadow: var(--shadow-md);
}

.hig-card:hover {
  transform: translateY(-2px);
}

/* === NAVIGATION BAR === */
.hig-navbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3) var(--space-4);
  background: var(--material-regular);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-bottom: 0.5px solid var(--separator);
  position: sticky;
  top: 0;
  z-index: 100;
}

.hig-navbar-title {
  font-size: var(--text-headline);
  font-weight: var(--weight-semibold);
  color: var(--label-primary);
}

/* === BACK BUTTON === */
.hig-back-button {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  min-width: var(--touch-target-min);
  min-height: var(--touch-target-min);
  padding: var(--space-2);
  background: transparent;
  color: var(--tint-color);
  font-size: var(--text-body);
  font-weight: var(--weight-regular);
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  text-decoration: none;
  transition: opacity var(--duration-fast);
}

.hig-back-button:hover {
  opacity: 0.7;
}

/* === SEGMENTED CONTROL === */
.hig-segmented-control {
  display: inline-flex;
  background: var(--fill-tertiary);
  border-radius: var(--radius-sm);
  padding: 2px;
}

.hig-segment {
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-subheadline);
  font-weight: var(--weight-medium);
  color: var(--label-secondary);
  background: transparent;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all var(--duration-fast);
  min-height: 32px;
}

.hig-segment:hover {
  color: var(--label-primary);
}

.hig-segment.active {
  background: var(--system-background-secondary);
  color: var(--label-primary);
  box-shadow: var(--shadow-sm);
}

/* === BADGES === */
.hig-badge {
  display: inline-flex;
  align-items: center;
  padding: var(--space-1) var(--space-2);
  font-size: var(--text-caption-1);
  font-weight: var(--weight-semibold);
  border-radius: var(--radius-full);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.hig-badge-tint {
  background: var(--tint-color-light);
  color: var(--tint-color);
}

.hig-badge-positive {
  background: rgba(52, 199, 89, 0.15);
  color: var(--positive-color);
}

.hig-badge-negative {
  background: rgba(255, 59, 48, 0.15);
  color: var(--negative-color);
}

.hig-badge-orange {
  background: rgba(255, 149, 0, 0.15);
  color: var(--system-orange);
}

/* === METRIC DISPLAY === */
.hig-metric {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.hig-metric-value {
  font-size: var(--text-title-1);
  font-weight: var(--weight-bold);
  font-variant-numeric: tabular-nums;
  letter-spacing: var(--tracking-tight);
  color: var(--label-primary);
}

.hig-metric-value.positive {
  color: var(--positive-color);
}

.hig-metric-value.negative {
  color: var(--negative-color);
}

.hig-metric-label {
  font-size: var(--text-caption-1);
  color: var(--label-secondary);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

/* === INPUT FIELDS === */
.hig-input {
  width: 100%;
  padding: var(--space-3) var(--space-4);
  font-family: var(--font-system);
  font-size: var(--text-body);
  color: var(--label-primary);
  background: var(--fill-tertiary);
  border: none;
  border-radius: var(--radius-md);
  outline: none;
  transition: all var(--duration-fast);
}

.hig-input::placeholder {
  color: var(--label-tertiary);
}

.hig-input:focus {
  background: var(--fill-secondary);
  box-shadow: 0 0 0 2px var(--tint-color);
}

/* === DIVIDERS === */
.hig-divider {
  height: 0.5px;
  background: var(--separator);
  margin: var(--space-4) 0;
}

/* ============================================================================
   ACCESSIBILITY
   ============================================================================ */

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

:focus-visible {
  outline: 2px solid var(--tint-color);
  outline-offset: 2px;
}

:focus:not(:focus-visible) {
  outline: none;
}

.skip-link {
  position: absolute;
  top: -100px;
  left: var(--space-4);
  padding: var(--space-3) var(--space-4);
  background: var(--tint-color);
  color: #ffffff;
  font-weight: var(--weight-semibold);
  border-radius: var(--radius-md);
  z-index: 10001;
  text-decoration: none;
}

.skip-link:focus {
  top: var(--space-4);
}

@media (prefers-contrast: high) {
  :root {
    --fill-primary: rgba(120, 120, 128, 0.5);
    --fill-secondary: rgba(120, 120, 128, 0.45);
  }
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ============================================================================
   UTILITY CLASSES
   ============================================================================ */
.text-primary { color: var(--label-primary); }
.text-secondary { color: var(--label-secondary); }
.text-tertiary { color: var(--label-tertiary); }
.text-tint { color: var(--tint-color); }
.text-positive { color: var(--positive-color); }
.text-negative { color: var(--negative-color); }

.bg-primary { background: var(--system-background); }
.bg-secondary { background: var(--system-background-secondary); }
.bg-tertiary { background: var(--system-background-tertiary); }

.font-bold { font-weight: var(--weight-bold); }
.font-semibold { font-weight: var(--weight-semibold); }
.font-medium { font-weight: var(--weight-medium); }
